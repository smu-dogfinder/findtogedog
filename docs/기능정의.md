# 함께찾개 – 기능 정의서 (MVP 기준)

본 문서는 예선 제출 및 본선 MVP 개발 기준의 핵심 기능 정의서이다.  
MVP는 아래 2기능을 End-to-End로 이어서 구현하는 것을 목표로 한다:

1) 성견 이미지 생성  
2) 유사견 검색  

---

## 기능 A – 성견 이미지 생성

### 기능 목적
강아지 시절 사진만 존재하는 경우에도, 성견 시기 예상 외모를 생성하여  
반환 매칭 성공률 향상.

### Input / Output

| 구분 | 내용 |
|---|---|
| Input | 사용자 업로드 이미지(JPG/PNG) |
| Output | 성견 이미지 1장 (예: 768~1024 해상도) |

### Functional Flow

| 단계 | 시스템 동작 |
|---|---|
| A1 | 사용자가 강아지 사진 업로드 |
| A2 | YOLOv8 Detection → dog 영역 crop (배경 최소화) |
| A3 | YOLOv8 + Segmentation + K-means → 품종/색상 정보 추출 |
| A4 | Stable Diffusion 1.5 + LoRA + IP-Adapter 기반으로 성견 이미지 생성 |
| A5 | 결과 이미지 반환 |

### 예외조건

| 상황 | 처리 |
|---|---|
| dog detection 실패 | "강아지가 인식되지 않습니다" 알림 |

---

## 기능 B – 유사견 검색

### 기능 목적
생성된 성견 이미지 또는 기존 등록 이미지를 입력으로
보호소 DB에서 유사한 개체 추천.

### Input / Output

| 구분 | 내용 |
|---|---|
| Input | 검색 기준 이미지 1장 |
| Output | Top-N 유사견 리스트 + similarity score |

### Functional Flow

| 단계 | 시스템 동작 |
|---|---|
| B1 | YOLOv8 crop |
| B2 | CLIP 임베딩 추출 |
| B3 | DB 내 pre-computed 임베딩과 cosine similarity 계산 |
| B4 | ΔE 기반 색상 유사도 반영 |
| B5 | 최종 score = 0.8 * 이미지 + 0.2 * 색상 ± penalty |
| B6 | Top-N 결과 반환 |

---

## 데이터 전제
- 경기데이터드림 유기동물 보호현황 데이터 활용
- duplicate / invalid image 제거
- bbox crop 기반으로 임베딩 재산출 (정확도 개선 목적)
